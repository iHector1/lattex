%% tirepage_components_v3_FIXED.tex
%% TireCard UI v3 - VERSIÓN CORREGIDA
%% Cambios: mejor espaciado, fallbacks para fuentes, sin LR errors

\makeatletter
\@ifundefined{TirePageComponentsLoadedVThree}{%
  \def\TirePageComponentsLoadedVThree{1}%
}{%
  \endinput%
}
\makeatother

% =========================
% COLORES
% =========================
\providecolor{brandblue}{HTML}{0B4AA2}
\providecolor{headgray}{HTML}{E7E7E7}
\providecolor{valuegray}{HTML}{F3F3F3}
\providecolor{psigreen}{HTML}{6FB23D}
\providecolor{psiblue}{HTML}{2D6FB9}
\providecolor{softgreen}{HTML}{DFF3D7}
\providecolor{softgreentext}{HTML}{2E7D32}
\providecolor{warningyellow}{HTML}{FFD700}

% =========================
% HELPERS
% =========================
\makeatletter
\providecommand{\TPFirst}[1]{\expandafter\@firstoftwo#1}
\providecommand{\TPSecond}[1]{\expandafter\@secondoftwo#1}
\makeatother

% =========================
% Fallback para kodemono
% =========================
\providecommand{\kodemono}{\ttfamily}

% =========================
% WRAPPERS
% =========================
\newcommand{\TireCardBox}[2]{%
  \begin{minipage}[t]{#1}#2\end{minipage}%
}

\providecommand{\WheelTitle}[1]{%
  \noindent\centering{\kodemono\fontseries{sb}\fontsize{10.5}{12.5}\selectfont #1}\par\vspace{1.2mm}%
}

% =========================
% CARD HEADER
% =========================
\newcommand{\TPCardHeader}[2]{%
  \noindent
  \tcbox[
    on line, enhanced,
    colback=brandblue, colframe=brandblue,
    boxrule=0pt, arc=0mm,
    left=2mm, right=2mm, top=1mm, bottom=1mm,
    width=0.30\linewidth,
    height=7.2mm,
    valign=center, halign=center
  ]{\includegraphics[height=4.8mm]{#1}}%
  \tcbox[
    on line, enhanced,
    colback=headgray, colframe=headgray,
    boxrule=0pt, arc=0mm,
    left=2mm, right=2mm, top=0.9mm, bottom=0.9mm,
    width=\dimexpr\linewidth-0.30\linewidth\relax,
    height=7.2mm,
    valign=center
  ]{%
    \begin{minipage}[c][7.2mm][c]{\linewidth}%
      \raggedright%
      \fontsize{6.2}{7.0}\selectfont\bfseries #2%
    \end{minipage}%
  }%
}

% =========================
% MÉTRICAS NORMALES
% =========================
\newcommand{\TPMetric}[2]{%
  \begin{tcolorbox}[
    enhanced,
    colback=white, colframe=white,
    boxrule=0pt, arc=0mm,
    left=0mm, right=0mm, top=0mm, bottom=0mm,
    boxsep=0mm,
    height=19mm,
    valign=top
  ]
    \tcbox[
      enhanced,
      colback=warningyellow, colframe=warningyellow,
      boxrule=0pt,
      arc=2mm,
      left=1mm, right=1mm, top=1.2mm, bottom=1.2mm,
      width=\linewidth,
      height=7.0mm,
      valign=center,
      halign=center
    ]{\fontsize{7.0}{8.0}\selectfont\bfseries #1}%
    \vspace{1.2mm}%
    \tcbox[
      enhanced,
      colback=valuegray, colframe=valuegray,
      boxrule=0pt,
      arc=2mm,
      left=1mm, right=1mm, top=1mm, bottom=1mm,
      width=\linewidth,
      height=9.8mm,
      valign=center,
      halign=center
    ]{\fontsize{9.2}{10.8}\selectfont\bfseries #2}%
  \end{tcolorbox}%
}

% =========================
% MÉTRICA PSI
% =========================
\newcommand{\TPMetricPSI}[1]{%
  \begin{tcolorbox}[
    enhanced,
    colback=white, colframe=white,
    boxrule=0pt, arc=0mm,
    left=0mm, right=0mm, top=0mm, bottom=0mm,
    boxsep=0mm,
    height=19mm,
    valign=top
  ]
    % PSI amarillo
    \tcbox[
      enhanced,
      colback=warningyellow, colframe=warningyellow,
      boxrule=0pt,
      arc=2mm,
      left=1mm, right=1mm, top=1.2mm, bottom=1.2mm,
      width=\linewidth,
      height=7.0mm,
      valign=center,
      halign=center
    ]{\fontsize{7.0}{8.0}\selectfont\bfseries PSI}%

    \vspace{0.9mm}%

    % Chips
    \noindent
    \tcbox[
      on line, enhanced,
      colback=psigreen, colframe=psigreen,
      boxrule=0pt, arc=1.2mm,
      left=0.8mm, right=0.8mm, top=0.6mm, bottom=0.6mm,
      width=0.50\linewidth,
      height=4.2mm,
      valign=center, halign=center
    ]{\fontsize{5.4}{6.2}\selectfont\bfseries\color{white} RECOMENDADO}%
    \tcbox[
      on line, enhanced,
      colback=psiblue, colframe=psiblue,
      boxrule=0pt, arc=1.2mm,
      left=0.8mm, right=0.8mm, top=0.6mm, bottom=0.6mm,
      width=0.50\linewidth,
      height=4.2mm,
      valign=center, halign=center
    ]{\fontsize{5.4}{6.2}\selectfont\bfseries\color{white} ACTUAL}%

    \vspace{0.9mm}%

    % Valores
    \noindent
    \tcbox[
      on line, enhanced,
      colback=valuegray, colframe=valuegray,
      boxrule=0pt, arc=2mm,
      left=0mm, right=0mm, top=0mm, bottom=0mm,
      width=0.50\linewidth,
      height=9.0mm,
      valign=center, halign=center
    ]{\fontsize{9.2}{10.8}\selectfont\bfseries \TPFirst{#1}}%
    \tcbox[
      on line, enhanced,
      colback=valuegray, colframe=valuegray,
      boxrule=0pt, arc=2mm,
      left=0mm, right=0mm, top=0mm, bottom=0mm,
      width=0.50\linewidth,
      height=9.0mm,
      valign=center, halign=center
    ]{\fontsize{9.2}{10.8}\selectfont\bfseries \TPSecond{#1}}%
  \end{tcolorbox}%
}

% =========================
% BARRA DE SECCIÓN
% =========================
\newcommand{\TPSectionBar}[1]{%
  \tcbox[
    enhanced,
    colback=headgray, colframe=headgray,
    boxrule=0pt,
    arc=2mm,
    left=1mm, right=1mm, top=1mm, bottom=1mm,
    width=\linewidth,
    height=7.0mm,
    valign=center,
    halign=center
  ]{\fontsize{10}{12}\selectfont\bfseries #1}%
}

% =========================
% CELDAS DE FRENOS
% =========================
\newcommand{\TPCellY}[2]{%
  \tcbox[
    on line, enhanced,
    colback=warningyellow, colframe=warningyellow,
    boxrule=0pt,
    arc=2mm,
    left=1.2mm, right=1.2mm, top=1mm, bottom=1mm,
    width=#1,
    height=7.3mm,
    valign=center, halign=center
  ]{\fontsize{9}{11}\selectfont #2}%
}

\newcommand{\TPCellG}[2]{%
  \tcbox[
    on line, enhanced,
    colback=softgreen, colframe=softgreen,
    boxrule=0pt,
    arc=2mm,
    left=1.2mm, right=1.2mm, top=1mm, bottom=1mm,
    width=#1,
    height=7.3mm,
    valign=center, halign=center
  ]{\fontsize{9}{11}\selectfont\bfseries\color{softgreentext} #2}%
}

% =========================
% TIRE CARD PRINCIPAL
% =========================
\renewcommand{\TireCard}[9]{%
  \begin{tcolorbox}[
    enhanced,
    colback=white,
    colframe=black!18,
    arc=3mm,
    boxrule=0.6pt,
    left=2.2mm, right=2.2mm, top=2.0mm, bottom=2.0mm
  ]
    \TPCardHeader{#1}{#2}%
    \vspace{2.0mm}%

    % Métricas en raster (5 columnas)
    \begin{tcbraster}[
      raster columns=5,
      raster column skip=1.6mm,
      raster left skip=0mm,
      raster right skip=0mm
    ]
      \TPMetric{MEDIDA}{#3}%
      \TPMetric{ÍNDICE\\\mbox{}DE VELOCIDAD}{#4}%
      \TPMetric{ÍNDICE\\\mbox{}DE CARGA}{#5}%
      \TPMetricPSI{#6}%
      \TPMetric{PROFUNDIDAD\\MM}{#7}%
    \end{tcbraster}%

    \vspace{2.2mm}%
    \TPSectionBar{FRENOS, DISCOS Y TAMBORES}%
    \vspace{1.8mm}%

    % Fila Balatas
    \noindent
    \TPCellY{0.36\linewidth}{Balatas/Tambores}\hfill%
    \TPCellG{0.34\linewidth}{\TPFirst{#8}}\hfill%
    \TPCellY{0.18\linewidth}{Desgaste}\hfill%
    \TPCellG{0.12\linewidth}{\TPSecond{#8}}\par%

    \vspace{1.2mm}%

    % Fila Discos
    \noindent
    \TPCellY{0.36\linewidth}{Discos}\hfill%
    \TPCellG{0.34\linewidth}{\TPFirst{#9}}\hfill%
    \TPCellY{0.18\linewidth}{Desgaste}\hfill%
    \TPCellG{0.12\linewidth}{\TPSecond{#9}}\par%
  \end{tcolorbox}%
}

\endinput